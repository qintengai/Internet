TCP三次握手四次挥手：https://blog.csdn.net/qzcsu/article/details/72861891

输入url后发生的事情：https://segmentfault.com/a/1190000006879700

HTTP长连接短链接：https://www.cnblogs.com/gotodsp/p/6366163.html

HTTP与HTTPS的区别：https://www.cnblogs.com/wqhwe/p/5407468.html

https://blog.csdn.net/qq_38289815/article/details/80969419

![img](file://C:/Users/17143/AppData/Roaming/Typora/typora-user-images/image-20210424185012707.png?lastModify=1619261408)

![image-20210424184946680](C:\Users\17143\AppData\Roaming\Typora\typora-user-images\image-20210424184946680.png)



网络字节序：

- 小端法：（pc本地存储）  高位存高地址，低位存低位地址
- 大端法：（网络存储）  高位存低地址，低位存高地址





#### 一、TCP

- tcp协议：16位源端口号  上限 2^16 = 65536，16位目的端口号，32位序号，32位确认序号，6个标志位，16位窗口大小。 2^16 = 65536



##### 三次握手、四次挥手



###### 流量控制：

- 流量控制用于防止在端口阻塞的情况下丢帧，这种方法是当发送或接收缓冲区开始溢出时通过将阻塞信号发送回源地址实现的。流量控制可以有效的防止由于网络中瞬间的大量数据对网络带来的冲击，保证用户网络高效而稳定的运行。

- 接收方每次发送确认报文的时候，可以告诉发送方的接收窗口大小，当为0时，发送方停止发送；之后发送方开发一个定时器，每隔一段时间发送测试报文去询问接收方的窗口大小。


###### 拥塞控制：

- 网络拥塞现象是指通信子网中某一部分的分组数量过多，使得该部分网络来不及处理，以致引起这部分乃至整个网络性能下降的现象，严重时甚至会导致网络通信业务陷入停顿，即出现死锁现象。拥塞控制是处理网络拥塞现象的一种机制。
- 拥塞控制：防止过多的数据注入到网络中，这样可以使网络中的路由器或链路不致过载。拥塞控制所要做的都有一个前提：网络能够承受现有的网络负荷。拥塞控制是一个全局性的过程，涉及到所有的主机、路由器，以及与降低网络传输性能有关的所有因素。
- 提高网络利用率，降低丢包率，并保证网络资源对每条数据流的公平性
- 1. **慢启动**：1，2，4.....指数增长
  2. **拥塞避免**：慢启动到底阀值，就开始线性增长
  3. 到达瓶颈值怎么办？把阀值调为瓶颈值的一半，接着再来用慢启动+拥塞避免
  4. 超时不一定就是网络拥塞
  5. **快速重传**：如果B收到了M1，M2，M4，M5却始终没有收到M3，那么B会连续给A发送M2的ACK确认报文，意在告诉A可能M3丢失了，当A连续收到M2的三次ACK，但M3还没超时，那么A就会发送M3.
  6. **快速恢复**：该事件发送之后，会把阀值设置为瓶颈值的一半，并且把滑动窗口设置为阀值，之后线性增长。这个版本也称为TCP Reno。而不具备这个功能的称之为TCP　Tahoe。


###### TCP拥塞控制和流量控制的区别?

1. 流量控制：是端到端的控制，例如A通过网络给B发数据，A发送的太快导致B没法接收（B缓冲窗口过小或者处理过慢），这是就是的控制就是流量控制，原理是通过滑动窗口的大小改变来实现。
2. 拥塞控制：是A与B之间的网络发生堵塞导致传输过慢或者丢包，来不及传输。防止过多的数据注入到网络中，这样可以使网络中的路由器或链路不至于过载。拥塞控制是一个全局性的过程，涉及到所有的主机、路由器，以及与降低网络性能有关的所有因素。

###### 可靠传输：

1. 确认－重传机制

2. 回退N步协议

   1. 接收方：如果是按序到达的，则接收，否则发送ACK确认
   2. 发送方：
      - 收到M４的ACK，代表M４之前的也正常交付了
      - 发送超时事件时，会重发所有已经发送但未得到确认的报文。注意这个只设置一个定时器就可以了。

   3.选择重传

   1. 接收方会缓存没有按序达到的报文,等到按序后,再发送ACK
   2. 发送方会为每个报文设置一个定时器,哪个超时就发送哪个

###### TCP建立连接时，为什么是3次握手，而不是2或4次？

1. 为什么不能是两次握手？

   - 第一步：客户端发送一个起始序列号seq=x的报文段给服务器
   - 第二步：服务器端返回向客户端发送确认号ack = x+1,表示对客户端的起始序列号x表示确认，并告诉客户端，它的起始序列号是seq = y

   所以，为什么不能两次握手？

   - 这种情况下，只有服务器对客户端的起始序列号做了确认，但客户端却没有对服务器的起始序列号做确认，不能保证传输的可靠性。
   - 防止失效的连接请求报文段被服务器接收，从而产生错误，浪费资源。

2. 为什么不是四次握手？

   - 第一步：客户端A发送同步信号SYN+A的初始序列号seq=x
   - 第二步：服务器端B确认收到A的同步信号，并记录A的初始序列号到本地，并向A发送确认信息ack = x+1
   - 第三步：B发送同步信号SYN+B的初始序列号seq给客户端A。
   - 第四步：A确认收到B的同步信号，并记录B'的初始序列号到本地，并向B发送确认信息ack = y +1.

   很显然，第二、三步可以合并，只需要三次握手，可以提高连接的速度与效率。

   总结：

   1. 保证信道数据传输的可靠性
   2. 避免资源浪费
   3. 三次是保证双方互相明确对方能收能发的最低值。

###### 怎么用UDP实现TCP？

1. 添加seq/ack机制，确保数据发送到对端
2. 添加发送和接收缓冲区，主要是用户超时重传
3. 添加超时重传机制

###### 为什么不是两次、四次？

TCP连接：用于保证可靠性和流量控制维护的某些状态信息，这些信息的组合包括**Socket、序列号和窗口大小**成为连接。

###### SYN洪泛攻击？原理？

半队列连接是服务器完成了第一次握手后将连接请求添加到的一个队列，而SYN攻击就是利用了这一点，客户端不断地发送伪造的SYN包来填满服务器的半连接队列，使得正常的连接请求得不到响应。



#### 二、IP

**IP协议是TCP/IP协议族的动力，它为上层协议提供无状态、无连接、不可靠的服务。**

1. 无状态
   1. 是指IP通信双方不同步传输数据的状态信息，因此所有IP数据报的发送、传输和接收都是相互独立的、没有上下文关系
   2. 无状态服务的优点：简单、高效
2. 无连接：是指IP通信双方都不长久地维持对方的任何信息
3. 不可靠：指IP协议不能保证IP数据报准确地到达接收端，它只是承诺尽最大努力。

#### 三、UDP

- udp协议：16位源端口号，2^16 =  65536，16位目的端口号

1. UDP是一种无连接的传输层协议，提供面向事务的简单不可靠信息传送服务。可靠性由上层应用实现，所以要实现udp可靠性传输，必须通过应用层来实现和控制。
2. UDP提供的是不可靠传输服务，具有TCP没有的优势：
   - UDP是无连接的，在时间上不存在建立连接需要的延时，在空间上，TCP需要在系统中维护连接状态，需要一定的开销。UDP不需要维护连接状态，也不跟踪这些参数，开销小，时间和空间上都具有优势。
   - 分组首部开销小，TCP首部20字节，UDP首部8字节。
   - UDP没有拥塞控制，应用层能够更好的控制要发送的苏剧和发送时间，网络中的拥塞控制也不会影响主机的发送速率。
   - UDP提供尽最大的努力交付，不保证可靠交付。所以维护传输可靠性的工作需要用户在应用层来完成，没有TCP的确认机制，重传机制。
   - UDP是面向报文的，对应用层传下来的报文，添加首部信息后直接向下交付给IP层。既不合并，也不拆分（TCP有粘包拆包问题）。对于IP层交上来的UDP用户数据报，在去除首部后就原封不动的交付给上层应用进程，报文不可分割，是UDP数据报的最小单位。
   - UDP常用一次性传输比较少量数据的网络应用，如DNS,SNMP等，因为对于这些应用，若是采用TCP，为连接的创建，维护和拆除带来不小的开销。UDP也常用于多媒体应用（如IP电话，实时视 频会议，流媒体等）数据的可靠传输对他们而言并不重要，TCP的拥塞控制会使他们有较大的延迟，也是不可容忍的。



































